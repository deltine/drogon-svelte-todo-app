# ログインの設計

- 未ログイン
1. フロントリクエスト  
   (ex)/localhost/todo

2. フロントのHandleでログインチェック  
   クッキーを参照して無ければログイン画面へリダイレクト  
   ※リダイレクトならばHandle呼ばれない？⇒Ｈandle呼ばれる・・・。

3. ログインボタン押下(異常系)
   1. ログイン情報入力(異常値)
   2. ログインボタン押下
   3. ログインAPI呼出し
   4. ログイン不正を通知(Cookie、Session無し)
   5. フロントでログイン不正表示
   
4. ログインボタン押下(正常系)
   1. ログイン情報入力(正常値)
   2. ログインボタン押下
   3. ログインAPI呼出し
      1. ログイン情報確認(正常)
      2. Cookie作成
         - ログイントークン生成
      3. Session作成
         - Cookieのログイントークンを保存
         - 生成時間を保存
      4. 正常レスポンス(Cookie付加)
   4. フロントでログイン後画面へ遷移  
      (ex)/localhost/todo

- ログイン済
1. フロントリクエスト  
   (ex)/localhost/todo
2. フロントのHandleでログインチェック 
   1. クッキーを参照
      1. クッキーがある
         1. 期限確認
            1. 期限切れ
               1. 未ログイン対応
            2. 期限有効
               1. ログインチェックAPIリクエスト
3. ログインチェックAPI
   1. クッキーの有効期限
      1. 無効
         1. ログイン失敗
      2. 有効
         1. 後続処理へ
   2. クッキーからログイントークン取得
   3. ログイントークン確認(session)
      1. 無効
         1. ログイン失敗
      2. 有効
         1. 後続処理へ
   4. ログイントークンの更新
   5. 正常レスポンス(Cookie付加)
4. フロントでログイン後画面へ遷移  
   (ex)/localhost/todo
